{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "VirtualNetworkName": {
            "type": "string"
        },
        "RemoteVirtualNetworkName": {
            "type": "string"
        },
        "RemoteVirtualNetworkSubscriptionID": {
            "type": "string"
        },
        "RemoteVirtualNetworkResourceGroup": {
            "type": "string"
        }
    },
    "resources": [
        {
            "apiVersion": "2017-10-01",
            "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
            "name": "[concat(parameters('VirtualNetworkName'), '/Peered-to-', parameters('RemoteVirtualNetworkName'))]",
            "location": "[resourceGroup().location]",
            "properties": {
                "allowVirtualNetworkAccess": true,
                "allowForwardedTraffic": false,
                "allowGatewayTransit": false,
                "useRemoteGateways": false,
                "remoteVirtualNetwork": {
                    "id": "[resourceId(parameters('RemoteVirtualNetworkSubscriptionID'), parameters('RemoteVirtualNetworkResourceGroup'),'Microsoft.Network/virtualNetworks', parameters ('RemoteVirtualNetworkName'))]"
                }
            }
        }
    ]
}

// {
//     "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
//     "contentVersion": "1.0.0.0",
//     "parameters": {
//         "VirtualNetworkName": {
//             "type": "string",
//             "metadata": {
//                 "description": "Set the local VNet name"
//             }
//         },
//         "RemoteVirtualNetworkName": {
//             "type": "string",
//             "metadata": {
//                 "description": "Set the remote VNet name"
//             }
//         },
//         "RemoteVirtualNetworkResourceGroupName": {
//             "type": "string",
//             "metadata": {
//                 "description": "Sets the remote VNet Resource group"
//             }
//         }
//     },
//     "resources": [
//         {
//             "name": "[concat(parameters('VirtualNetworkName'), '/peering-to-remote-vnet')]",
//             "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
//             "location": "[resourceGroup().location]",
//             "apiVersion": "2019-11-01",
//             "properties": {
//                 "allowVirtualNetworkAccess": true,
//                 "allowForwardedTraffic": false,
//                 "allowGatewayTransit": false,
//                 "useRemoteGateways": false,
//                 "remoteVirtualNetwork": {
//                     "id": "[resourceId(parameters('RemoteVirtualNetworkResourceGroupName'), 'Microsoft.Network/virtualNetworks', parameters('RemoteVirtualNetworkName'))]"
//                 }
//             }
//         }
//     ]
// }
